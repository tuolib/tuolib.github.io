import{c as G,B as U,l as j,h as q,G as J}from"./use-translate.a196871a.js";import{n as B,m as T,c as K,t as L,a as O,w as Q}from"./with-install.a0bab54c.js";import{u as W}from"./use-refs.0cf5deac.js";import{u as Y}from"./use-touch.0eed9279.js";import{I as N}from"./index.75bcb902.js";import{A as Z,D as $,e as u}from"./vue-libs.fd74807a.js";const[x,d]=G("rate");function p(e,o,l,i){return e>=o?{status:"full",value:1}:e+.5>=o&&l&&!i?{status:"half",value:.5}:e+1>=o&&l&&i?{status:"half",value:Math.round((e-o+1)*1e10)/1e10}:{status:"void",value:0}}const ee={size:B,icon:T("star"),color:String,count:K(5),gutter:B,readonly:Boolean,disabled:Boolean,voidIcon:T("star-o"),allowHalf:Boolean,voidColor:String,touchable:L,iconPrefix:String,modelValue:O(0),disabledColor:String},ae=Z({name:x,props:ee,emits:["change","update:modelValue"],setup(e,{emit:o}){const l=Y(),[i,h]=W(),b=()=>e.readonly||e.disabled||!e.touchable,A=$(()=>Array(+e.count).fill("").map((a,t)=>p(e.modelValue,t+1,e.allowHalf,e.readonly)));let s;const g=()=>{const a=i.value.map(J);s=[],a.forEach((t,n)=>{e.allowHalf?s.push({score:n+.5,left:t.left},{score:n+1,left:t.left+t.width/2}):s.push({score:n+1,left:t.left})})},v=a=>{for(let t=s.length-1;t>0;t--)if(a>s[t].left)return s[t].score;return e.allowHalf?.5:1},y=a=>{!e.disabled&&!e.readonly&&a!==e.modelValue&&(o("update:modelValue",a),o("change",a))},D=a=>{b()||(l.start(a),g())},F=a=>{if(!b()&&(l.move(a),l.isHorizontal())){const{clientX:t}=a.touches[0];j(a),y(v(t))}},M=(a,t)=>{const{icon:n,size:P,color:V,count:R,gutter:S,voidIcon:w,disabled:r,voidColor:C,allowHalf:k,iconPrefix:I,disabledColor:z}=e,f=t+1,m=a.status==="full",c=a.status==="void",X=k&&a.value>0&&a.value<1;let H;S&&f!==+R&&(H={paddingRight:q(S)});const _=E=>{g(),y(k?v(E.clientX):f)};return u("div",{key:t,ref:h(t),role:"radio",style:H,class:d("item"),tabindex:r?void 0:0,"aria-setsize":R,"aria-posinset":f,"aria-checked":!c,onClick:_},[u(N,{size:P,name:m?n:w,class:d("icon",{disabled:r,full:m}),color:r?z:m?V:C,classPrefix:I},null),X&&u(N,{size:P,style:{width:a.value+"em"},name:c?w:n,class:d("icon",["half",{disabled:r,full:!c}]),color:r?z:c?C:V,classPrefix:I},null)])};return U(()=>e.modelValue),()=>u("div",{role:"radiogroup",class:d({readonly:e.readonly,disabled:e.disabled}),tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,"aria-readonly":e.readonly,onTouchstart:D,onTouchmove:F},[A.value.map(M)])}}),te=Q(ae),ce=te;export{ce as V};
